// Norwegian postal codes to municipality mapping (selection of common codes)
export const postalCodeToMunicipality: Record<string, string> = {
  // Oslo
  '0010': 'Oslo', '0015': 'Oslo', '0018': 'Oslo', '0021': 'Oslo', '0024': 'Oslo',
  '0025': 'Oslo', '0026': 'Oslo', '0027': 'Oslo', '0028': 'Oslo', '0030': 'Oslo',
  '0031': 'Oslo', '0032': 'Oslo', '0033': 'Oslo', '0034': 'Oslo', '0037': 'Oslo',
  '0040': 'Oslo', '0042': 'Oslo', '0043': 'Oslo', '0045': 'Oslo', '0046': 'Oslo',
  '0047': 'Oslo', '0048': 'Oslo', '0050': 'Oslo', '0051': 'Oslo', '0055': 'Oslo',
  '0101': 'Oslo', '0102': 'Oslo', '0103': 'Oslo', '0104': 'Oslo', '0105': 'Oslo',
  '0106': 'Oslo', '0107': 'Oslo', '0110': 'Oslo', '0112': 'Oslo', '0113': 'Oslo',
  '0114': 'Oslo', '0115': 'Oslo', '0116': 'Oslo', '0117': 'Oslo', '0118': 'Oslo',
  '0119': 'Oslo', '0120': 'Oslo', '0121': 'Oslo', '0122': 'Oslo', '0123': 'Oslo',
  '0124': 'Oslo', '0125': 'Oslo', '0128': 'Oslo', '0129': 'Oslo', '0130': 'Oslo',
  '0131': 'Oslo', '0132': 'Oslo', '0133': 'Oslo', '0134': 'Oslo', '0135': 'Oslo',
  '0136': 'Oslo', '0137': 'Oslo', '0138': 'Oslo', '0139': 'Oslo', '0150': 'Oslo',
  '0151': 'Oslo', '0152': 'Oslo', '0153': 'Oslo', '0154': 'Oslo', '0155': 'Oslo',
  '0157': 'Oslo', '0158': 'Oslo', '0159': 'Oslo', '0160': 'Oslo', '0161': 'Oslo',
  '0162': 'Oslo', '0163': 'Oslo', '0164': 'Oslo', '0165': 'Oslo', '0166': 'Oslo',
  '0167': 'Oslo', '0168': 'Oslo', '0169': 'Oslo', '0170': 'Oslo', '0171': 'Oslo',
  '0172': 'Oslo', '0173': 'Oslo', '0174': 'Oslo', '0175': 'Oslo', '0176': 'Oslo',
  '0177': 'Oslo', '0178': 'Oslo', '0179': 'Oslo', '0180': 'Oslo', '0181': 'Oslo',
  '0182': 'Oslo', '0183': 'Oslo', '0184': 'Oslo', '0185': 'Oslo', '0186': 'Oslo',
  '0187': 'Oslo', '0188': 'Oslo', '0190': 'Oslo', '0191': 'Oslo', '0192': 'Oslo',
  '0193': 'Oslo', '0194': 'Oslo', '0195': 'Oslo', '0196': 'Oslo', '0198': 'Oslo',
  
  // Bergen
  '5003': 'Bergen', '5004': 'Bergen', '5005': 'Bergen', '5006': 'Bergen',
  '5007': 'Bergen', '5008': 'Bergen', '5009': 'Bergen', '5010': 'Bergen',
  '5011': 'Bergen', '5012': 'Bergen', '5013': 'Bergen', '5014': 'Bergen',
  '5015': 'Bergen', '5016': 'Bergen', '5017': 'Bergen', '5018': 'Bergen',
  '5019': 'Bergen', '5020': 'Bergen', '5021': 'Bergen', '5022': 'Bergen',
  
  // Trondheim
  '7010': 'Trondheim', '7011': 'Trondheim', '7012': 'Trondheim', '7013': 'Trondheim',
  '7014': 'Trondheim', '7015': 'Trondheim', '7016': 'Trondheim', '7018': 'Trondheim',
  '7019': 'Trondheim', '7020': 'Trondheim', '7021': 'Trondheim', '7022': 'Trondheim',
  '7023': 'Trondheim', '7024': 'Trondheim', '7025': 'Trondheim', '7026': 'Trondheim',
  '7027': 'Trondheim', '7028': 'Trondheim', '7029': 'Trondheim', '7030': 'Trondheim',
  
  // Stavanger
  '4001': 'Stavanger', '4002': 'Stavanger', '4003': 'Stavanger', '4004': 'Stavanger',
  '4005': 'Stavanger', '4006': 'Stavanger', '4007': 'Stavanger', '4008': 'Stavanger',
  '4009': 'Stavanger', '4010': 'Stavanger', '4011': 'Stavanger', '4012': 'Stavanger',
  '4013': 'Stavanger', '4014': 'Stavanger', '4015': 'Stavanger', '4016': 'Stavanger',
  
  // Kristiansand
  '4604': 'Kristiansand', '4605': 'Kristiansand', '4606': 'Kristiansand',
  '4608': 'Kristiansand', '4609': 'Kristiansand', '4610': 'Kristiansand',
  '4611': 'Kristiansand', '4612': 'Kristiansand', '4613': 'Kristiansand',
  '4614': 'Kristiansand', '4615': 'Kristiansand', '4616': 'Kristiansand',
  
  // Tromsø
  '9006': 'Tromsø', '9007': 'Tromsø', '9008': 'Tromsø', '9009': 'Tromsø',
  '9010': 'Tromsø', '9011': 'Tromsø', '9012': 'Tromsø', '9013': 'Tromsø',
  '9014': 'Tromsø', '9015': 'Tromsø', '9016': 'Tromsø', '9017': 'Tromsø',
  
  // Drammen
  '3001': 'Drammen', '3002': 'Drammen', '3003': 'Drammen', '3004': 'Drammen',
  '3005': 'Drammen', '3006': 'Drammen', '3007': 'Drammen', '3008': 'Drammen',
  
  // Fredrikstad
  '1601': 'Fredrikstad', '1602': 'Fredrikstad', '1603': 'Fredrikstad',
  '1604': 'Fredrikstad', '1605': 'Fredrikstad', '1606': 'Fredrikstad',
  '1607': 'Fredrikstad', '1608': 'Fredrikstad', '1609': 'Fredrikstad',
  
  // Sandnes
  '4301': 'Sandnes', '4302': 'Sandnes', '4303': 'Sandnes', '4304': 'Sandnes',
  '4305': 'Sandnes', '4306': 'Sandnes', '4307': 'Sandnes', '4308': 'Sandnes',
  
  // Sarpsborg
  '1701': 'Sarpsborg', '1702': 'Sarpsborg', '1703': 'Sarpsborg',
  '1704': 'Sarpsborg', '1705': 'Sarpsborg', '1706': 'Sarpsborg',
  '1707': 'Sarpsborg', '1708': 'Sarpsborg', '1709': 'Sarpsborg',
  
  // Skien
  '3701': 'Skien', '3702': 'Skien', '3703': 'Skien', '3704': 'Skien',
  '3705': 'Skien', '3706': 'Skien', '3707': 'Skien', '3708': 'Skien',
  
  // Ålesund
  '6001': 'Ålesund', '6002': 'Ålesund', '6003': 'Ålesund', '6004': 'Ålesund',
  '6005': 'Ålesund', '6006': 'Ålesund', '6007': 'Ålesund', '6008': 'Ålesund',
  
  // Tønsberg
  '3101': 'Tønsberg', '3102': 'Tønsberg', '3103': 'Tønsberg', '3104': 'Tønsberg',
  '3105': 'Tønsberg', '3106': 'Tønsberg', '3107': 'Tønsberg', '3108': 'Tønsberg',
  
  // Haugesund
  '5501': 'Haugesund', '5502': 'Haugesund', '5503': 'Haugesund', '5504': 'Haugesund',
  '5505': 'Haugesund', '5506': 'Haugesund', '5507': 'Haugesund', '5508': 'Haugesund',
  
  // Sandefjord
  '3201': 'Sandefjord', '3202': 'Sandefjord', '3203': 'Sandefjord', '3204': 'Sandefjord',
  '3205': 'Sandefjord', '3206': 'Sandefjord', '3207': 'Sandefjord', '3208': 'Sandefjord',
  
  // Bodø
  '8001': 'Bodø', '8002': 'Bodø', '8003': 'Bodø', '8004': 'Bodø',
  '8005': 'Bodø', '8006': 'Bodø', '8007': 'Bodø', '8008': 'Bodø',
  
  // Arendal
  '4801': 'Arendal', '4802': 'Arendal', '4803': 'Arendal', '4804': 'Arendal',
  '4808': 'Arendal', '4809': 'Arendal', '4810': 'Arendal', '4812': 'Arendal',
  
  // Hamar
  '2301': 'Hamar', '2302': 'Hamar', '2303': 'Hamar', '2304': 'Hamar',
  '2305': 'Hamar', '2306': 'Hamar', '2307': 'Hamar', '2308': 'Hamar',
  
  // Larvik
  '3251': 'Larvik', '3252': 'Larvik', '3253': 'Larvik', '3254': 'Larvik',
  '3255': 'Larvik', '3256': 'Larvik', '3257': 'Larvik', '3258': 'Larvik',
  
  // Halden
  '1751': 'Halden', '1752': 'Halden', '1753': 'Halden', '1754': 'Halden',
  '1755': 'Halden', '1756': 'Halden', '1757': 'Halden', '1758': 'Halden',
  
  // Mo i Rana
  '8601': 'Rana', '8602': 'Rana', '8603': 'Rana', '8604': 'Rana',
  '8605': 'Rana', '8606': 'Rana', '8607': 'Rana', '8608': 'Rana',
  
  // Gjøvik
  '2801': 'Gjøvik', '2802': 'Gjøvik', '2803': 'Gjøvik', '2804': 'Gjøvik',
  '2805': 'Gjøvik', '2806': 'Gjøvik', '2807': 'Gjøvik', '2808': 'Gjøvik',
  
  // Lillehammer
  '2601': 'Lillehammer', '2602': 'Lillehammer', '2603': 'Lillehammer',
  '2604': 'Lillehammer', '2605': 'Lillehammer', '2606': 'Lillehammer',
  '2607': 'Lillehammer', '2608': 'Lillehammer', '2609': 'Lillehammer',
  
  // Molde
  '6401': 'Molde', '6402': 'Molde', '6403': 'Molde', '6404': 'Molde',
  '6405': 'Molde', '6406': 'Molde', '6407': 'Molde', '6408': 'Molde',
  
  // Ski/Nordre Follo
  '1400': 'Nordre Follo', '1401': 'Nordre Follo', '1402': 'Nordre Follo',
  '1403': 'Nordre Follo', '1404': 'Nordre Follo', '1405': 'Nordre Follo',
  '1406': 'Nordre Follo', '1407': 'Nordre Follo', '1408': 'Nordre Follo',
  
  // Asker
  '1383': 'Asker', '1384': 'Asker', '1385': 'Asker', '1386': 'Asker',
  '1387': 'Asker', '1388': 'Asker', '1389': 'Asker', '1390': 'Asker',
  '1391': 'Asker', '1392': 'Asker', '1393': 'Asker', '1394': 'Asker',
  '1395': 'Asker', '1396': 'Asker', '1397': 'Asker',
  
  // Bærum
  '1340': 'Bærum', '1341': 'Bærum', '1342': 'Bærum', '1343': 'Bærum',
  '1344': 'Bærum', '1345': 'Bærum', '1346': 'Bærum', '1347': 'Bærum',
  '1348': 'Bærum', '1349': 'Bærum', '1350': 'Bærum', '1351': 'Bærum',
  '1352': 'Bærum', '1353': 'Bærum', '1354': 'Bærum', '1355': 'Bærum',
  '1356': 'Bærum', '1357': 'Bærum', '1358': 'Bærum', '1359': 'Bærum',
  '1360': 'Bærum', '1361': 'Bærum', '1362': 'Bærum', '1363': 'Bærum',
  '1364': 'Bærum', '1365': 'Bærum', '1366': 'Bærum', '1367': 'Bærum',
  '1368': 'Bærum', '1369': 'Bærum', '1370': 'Bærum', '1371': 'Bærum',
};

// Helper function to get municipality from postal code
export function getMunicipalityFromPostalCode(postalCode: string): string {
  // Remove any spaces and ensure 4 digits
  const cleanCode = postalCode.replace(/\s/g, '').padStart(4, '0');
  
  // Try exact match first
  if (postalCodeToMunicipality[cleanCode]) {
    return postalCodeToMunicipality[cleanCode];
  }
  
  // Try to find closest match for unknown codes
  const codeNum = parseInt(cleanCode);
  
  // General rules for Norwegian postal codes
  if (codeNum >= 0 && codeNum < 1300) return 'Oslo';
  if (codeNum >= 1300 && codeNum < 1400) return 'Bærum';
  if (codeNum >= 1400 && codeNum < 1500) return 'Nordre Follo';
  if (codeNum >= 1500 && codeNum < 1600) return 'Lørenskog';
  if (codeNum >= 1600 && codeNum < 1700) return 'Fredrikstad';
  if (codeNum >= 1700 && codeNum < 1800) return 'Sarpsborg';
  if (codeNum >= 1800 && codeNum < 1900) return 'Askim';
  if (codeNum >= 2000 && codeNum < 2100) return 'Lillestrøm';
  if (codeNum >= 2300 && codeNum < 2400) return 'Hamar';
  if (codeNum >= 2600 && codeNum < 2700) return 'Lillehammer';
  if (codeNum >= 2800 && codeNum < 2900) return 'Gjøvik';
  if (codeNum >= 3000 && codeNum < 3100) return 'Drammen';
  if (codeNum >= 3100 && codeNum < 3200) return 'Tønsberg';
  if (codeNum >= 3200 && codeNum < 3300) return 'Sandefjord';
  if (codeNum >= 3700 && codeNum < 3800) return 'Skien';
  if (codeNum >= 4000 && codeNum < 4100) return 'Stavanger';
  if (codeNum >= 4300 && codeNum < 4400) return 'Sandnes';
  if (codeNum >= 4600 && codeNum < 4700) return 'Kristiansand';
  if (codeNum >= 4800 && codeNum < 4900) return 'Arendal';
  if (codeNum >= 5000 && codeNum < 5100) return 'Bergen';
  if (codeNum >= 5500 && codeNum < 5600) return 'Haugesund';
  if (codeNum >= 6000 && codeNum < 6100) return 'Ålesund';
  if (codeNum >= 6400 && codeNum < 6500) return 'Molde';
  if (codeNum >= 7000 && codeNum < 7100) return 'Trondheim';
  if (codeNum >= 8000 && codeNum < 8100) return 'Bodø';
  if (codeNum >= 8600 && codeNum < 8700) return 'Mo i Rana';
  if (codeNum >= 9000 && codeNum < 9100) return 'Tromsø';
  
  // Default fallback
  return '';
}

// Get all unique municipalities for dropdown
export function getAllMunicipalities(): string[] {
  const municipalities = new Set(Object.values(postalCodeToMunicipality));
  return Array.from(municipalities).sort();
}